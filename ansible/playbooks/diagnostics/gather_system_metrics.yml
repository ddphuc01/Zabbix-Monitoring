---
- name: Gather System Metrics for AI Analysis
  hosts: "{{ target_host | default('all') }}"
  gather_facts: yes
  become: yes

  tasks:
    - name: Get CPU info
      shell: top -bn1 | head -20
      register: cpu_info

    - name: Get memory info
      shell: free -h
      register: mem_info

    - name: Get disk info
      shell: df -h
      register: disk_info

    - name: Get top processes
      shell: ps aux --sort=-%cpu | head -10
      register: top_processes

    - name: Display metrics
      debug:
        msg:
          - "=== CPU ==="
          - "{{ cpu_info.stdout }}"
          - "=== MEMORY ==="
          - "{{ mem_info.stdout }}"
          - "=== DISK ==="
          - "{{ disk_info.stdout }}"
          - "=== TOP PROCESSES ==="
          - "{{ top_processes.stdout }}"
